# MCP AI Summary Demo

## å°ˆæ¡ˆæ¦‚è¿°

é€™æ˜¯ä¸€å€‹ **Model Context Protocol (MCP)** å­¸ç¿’ç¯„ä¾‹å°ˆæ¡ˆï¼Œå±•ç¤ºå¦‚ä½•å»ºç«‹ä¸€å€‹ MCP Server ä¾†ï¼š

1. ğŸ“Š å¾**è³‡æ–™åº«**æˆ– **API** å–å¾— JSON è³‡æ–™
2. ğŸ“ ä½¿ç”¨**çµæ§‹åŒ– Prompt æ¨¡æ¿**ï¼Œå°‡è³‡æ–™å¸¶å…¥ä½”ä½ç¬¦
3. ğŸ¤– é€éæœ¬åœ° **Ollama Gemma 3 4B** ç”Ÿæˆ AI æ‘˜è¦
4. ğŸ”’ å…§å»º**è³‡æ–™é®ç½©**åŠŸèƒ½ï¼Œä¿è­·æ•æ„Ÿå€‹è³‡

---

## ğŸ¯ ä»€éº¼æ˜¯ MCPï¼Ÿ

**Model Context Protocol (MCP)** æ˜¯ä¸€å€‹é–‹æ”¾æ¨™æº–ï¼Œç”¨æ–¼é€£æ¥ AI æ‡‰ç”¨ç¨‹å¼èˆ‡å¤–éƒ¨ç³»çµ±ã€‚

æƒ³åƒ MCP å°±åƒæ˜¯ AI ä¸–ç•Œçš„ **USB-C æ¥å£**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    MCP å”è­°    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI å®¢æˆ¶ç«¯     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   MCP Server    â”‚
â”‚  (Claude ç­‰)    â”‚               â”‚  (ä½ çš„ç¨‹å¼ç¢¼)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                     â”‚                     â”‚
                    â–¼                     â–¼                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  è³‡æ–™åº«   â”‚         â”‚   API    â”‚         â”‚  æª”æ¡ˆç³»çµ± â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### MCP çš„ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ

| æ¦‚å¿µ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| **Resources** | æä¾›å¯è®€å–çš„è³‡æ–™ | è³‡æ–™åº«è¨˜éŒ„ã€è¨­å®šæª” |
| **Tools** | æä¾›å¯åŸ·è¡Œçš„åŠŸèƒ½ | æŸ¥è©¢è³‡æ–™ã€ç”Ÿæˆå ±å‘Š |
| **Prompts** | é å®šç¾©çš„ Prompt æ¨¡æ¿ | æ‘˜è¦æ¨¡æ¿ã€åˆ†ææ¨¡æ¿ |

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
MCP_AI_Summary_demo/
â”œâ”€â”€ pyproject.toml          # Python å°ˆæ¡ˆè¨­å®š
â”œâ”€â”€ .env.example            # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”œâ”€â”€ .gitignore              # Git å¿½ç•¥è¦å‰‡
â”œâ”€â”€ README.md               # æœ¬èªªæ˜æ–‡ä»¶
â”œâ”€â”€ test_local.py           # æœ¬åœ°æ¸¬è©¦è…³æœ¬
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py         # æ¨¡çµ„åˆå§‹åŒ–
â”‚   â”œâ”€â”€ server.py           # ğŸš€ MCP Server ä¸»ç¨‹å¼
â”‚   â”œâ”€â”€ config.py           # âš™ï¸ è¨­å®šç®¡ç†
â”‚   â”œâ”€â”€ data_source.py      # ğŸ“Š è³‡æ–™ä¾†æºï¼ˆDB/APIï¼‰
â”‚   â”œâ”€â”€ prompts.py          # ğŸ“ Prompt æ¨¡æ¿ç³»çµ±
â”‚   â”œâ”€â”€ ollama_client.py    # ğŸ¤– Ollama æ•´åˆ
â”‚   â””â”€â”€ security.py         # ğŸ”’ è³‡æ–™é®ç½©
â”‚
â””â”€â”€ data/
    â””â”€â”€ demo.db             # SQLite è³‡æ–™åº«ï¼ˆè‡ªå‹•å»ºç«‹ï¼‰
```

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. ç’°å¢ƒæº–å‚™

```powershell
# å®‰è£ uvï¼ˆPython å¥—ä»¶ç®¡ç†å™¨ï¼‰
irm https://astral.sh/uv/install.ps1 | iex

# é€²å…¥å°ˆæ¡ˆç›®éŒ„
cd MCP_AI_Summary_demo

# å»ºç«‹è™›æ“¬ç’°å¢ƒä¸¦å®‰è£ç›¸ä¾å¥—ä»¶
uv venv
.\.venv\Scripts\Activate.ps1
uv sync
```

### 2. è¨­å®šç’°å¢ƒè®Šæ•¸

```powershell
# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
Copy-Item .env.example .env

# ç·¨è¼¯ .env æª”æ¡ˆï¼ˆå¯é¸ï¼‰
```

### 3. å®‰è£ä¸¦å•Ÿå‹• Ollama

```powershell
# ä¸‹è¼‰ä¸¦å®‰è£ Ollama: https://ollama.com/download

# æ‹‰å– Gemma 3 4B æ¨¡å‹
ollama pull gemma3:4b

# å•Ÿå‹• Ollama æœå‹™ï¼ˆé€šå¸¸æœƒè‡ªå‹•å•Ÿå‹•ï¼‰
ollama serve
```

### 4. æ¸¬è©¦åŠŸèƒ½

```powershell
# åŸ·è¡Œæœ¬åœ°æ¸¬è©¦è…³æœ¬
uv run python test_local.py
```

---

## ğŸ”§ è¨­å®š MCP Client

### VS Code è¨­å®š

åœ¨ VS Code ä½¿ç”¨è€…è¨­å®šæˆ– `.vscode/mcp.json` ä¸­åŠ å…¥ï¼š

```json
{
  "mcp": {
    "servers": {
      "ai-summary": {
        "command": "uv",
        "args": [
          "--directory",
          "C:\\Users\\gn012\\OneDrive\\Desktop\\MCP_AI_Summary_demo",
          "run",
          "python",
          "-m",
          "src.server"
        ]
      }
    }
  }
}
```

### Claude Desktop è¨­å®š

ç·¨è¼¯ `%APPDATA%\Claude\claude_desktop_config.json`ï¼š

```json
{
  "mcpServers": {
    "ai-summary": {
      "command": "uv",
      "args": [
        "--directory",
        "C:\\Users\\gn012\\OneDrive\\Desktop\\MCP_AI_Summary_demo",
        "run",
        "python",
        "-m",
        "src.server"
      ]
    }
  }
}
```

---

## ğŸ“ ä½¿ç”¨æ–¹å¼

### å¯ç”¨çš„ Tools

| å·¥å…·åç¨± | åŠŸèƒ½ | åƒæ•¸ |
|---------|------|------|
| `query_employees` | æŸ¥è©¢å“¡å·¥è³‡æ–™ | `department`, `limit` |
| `query_projects` | æŸ¥è©¢å°ˆæ¡ˆè³‡æ–™ | `status`, `limit` |
| `fetch_api_data` | å¾ API å–å¾—è³‡æ–™ | `endpoint`, `limit` |
| `generate_summary` | ç”Ÿæˆ AI æ‘˜è¦ | `template_name`, `data`, `extra_vars` |
| `answer_question` | åŸºæ–¼è³‡æ–™å›ç­”å•é¡Œ | `question`, `data_source_type`, `filters` |
| `check_ollama_status` | æª¢æŸ¥ Ollama ç‹€æ…‹ | ç„¡ |
| `list_prompt_templates` | åˆ—å‡ºå¯ç”¨æ¨¡æ¿ | ç„¡ |

### å¯ç”¨çš„ Prompt æ¨¡æ¿

| æ¨¡æ¿åç¨± | ç”¨é€” | è®Šæ•¸ |
|---------|------|------|
| `data_summary` | é€šç”¨è³‡æ–™æ‘˜è¦ | `data` |
| `employee_analysis` | å“¡å·¥è³‡æ–™åˆ†æ | `department`, `employees` |
| `project_status` | å°ˆæ¡ˆç‹€æ…‹å ±å‘Š | `projects`, `current_date` |
| `api_data_summary` | API è³‡æ–™æ‘˜è¦ | `source`, `data_type`, `data`, `focus_areas` |
| `qa_with_context` | åŸºæ–¼è³‡æ–™å•ç­” | `context_data`, `question` |
| `custom_summary` | è‡ªè¨‚æ‘˜è¦ | `custom_instructions`, `data` |

### ç¯„ä¾‹å°è©±

åœ¨ AI å®¢æˆ¶ç«¯ä¸­ï¼Œä½ å¯ä»¥é€™æ¨£ä½¿ç”¨ï¼š

```
ä½¿ç”¨è€…ï¼šæŸ¥è©¢ç ”ç™¼éƒ¨çš„å“¡å·¥è³‡æ–™

AIï¼šï¼ˆå‘¼å« query_employees toolï¼‰
    æ‰¾åˆ° 2 ä½ç ”ç™¼éƒ¨å“¡å·¥...

ä½¿ç”¨è€…ï¼šå¹«æˆ‘åˆ†æé€™äº›å“¡å·¥è³‡æ–™

AIï¼šï¼ˆå‘¼å« generate_summary toolï¼Œä½¿ç”¨ employee_analysis æ¨¡æ¿ï¼‰
    æ ¹æ“šè³‡æ–™åˆ†æ...
```

---

## ğŸ”’ ä¼æ¥­å®‰å…¨è€ƒé‡

### è³‡æ–™é®ç½©åŠŸèƒ½

æœ¬å°ˆæ¡ˆå…§å»ºè³‡æ–™é®ç½©æ©Ÿåˆ¶ï¼Œè‡ªå‹•ä¿è­·æ•æ„Ÿæ¬„ä½ï¼š

```python
# åŸå§‹è³‡æ–™
{"email": "test@example.com", "phone": "0912-345-678"}

# é®ç½©å¾Œ
{"email": "t**t@example.com", "phone": "09******78"}
```

### é è¨­é®ç½©æ¬„ä½

- `email` - é›»å­éƒµä»¶
- `phone` - é›»è©±è™Ÿç¢¼
- `ssn` - ç¤¾æœƒå®‰å…¨è™Ÿç¢¼
- `credit_card` - ä¿¡ç”¨å¡è™Ÿ
- `password` - å¯†ç¢¼

### è¨­å®šè‡ªè¨‚é®ç½©

åœ¨ `.env` ä¸­è¨­å®šï¼š

```env
ENABLE_DATA_MASKING=true
MASKED_FIELDS=email,phone,ssn,credit_card,password,èº«åˆ†è­‰å­—è™Ÿ
```

### æœ¬åœ°éƒ¨ç½²å„ªå‹¢

ä½¿ç”¨ **Ollama** åœ¨æœ¬åœ°åŸ·è¡Œ LLMï¼Œè³‡æ–™ä¸æœƒå‚³é€åˆ°å¤–éƒ¨ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¼æ¥­å…§éƒ¨ç¶²è·¯                             â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ MCP Client  â”‚â”€â”€â”€â”€â–¶â”‚ MCP Server  â”‚â”€â”€â”€â”€â–¶â”‚   Ollama    â”‚    â”‚
â”‚  â”‚ (AI åŠ©ç†)    â”‚     â”‚ (æœ¬å°ˆæ¡ˆ)     â”‚     â”‚ (æœ¬åœ° LLM)  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚                                â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                      â”‚  ä¼æ¥­è³‡æ–™åº«  â”‚                         â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              âŒ è³‡æ–™ä¸å¤–æµ
```

---

## ğŸ“š MCP æ¶æ§‹è©³è§£

### é€šè¨Šæµç¨‹

```
1. Client å•Ÿå‹• MCP Serverï¼ˆé€é stdioï¼‰
2. Client ç™¼é€åˆå§‹åŒ–è«‹æ±‚
3. Server å›æ‡‰æ”¯æ´çš„åŠŸèƒ½ï¼ˆtools, resources, promptsï¼‰
4. Client å¯ä»¥ï¼š
   - è®€å– Resources å–å¾—è³‡æ–™
   - å‘¼å« Tools åŸ·è¡ŒåŠŸèƒ½
   - ä½¿ç”¨ Prompts å–å¾—é å®šç¾©æ¨¡æ¿
5. Server è™•ç†è«‹æ±‚ä¸¦å›å‚³çµæœ
```

### æœ¬å°ˆæ¡ˆçš„è³‡æ–™æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client    â”‚    â”‚ MCP Server  â”‚    â”‚ Data Source â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                   â”‚
       â”‚  query_employees â”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚
       â”‚                  â”‚  SQL Query        â”‚
       â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                  â”‚                   â”‚
       â”‚                  â”‚  Raw Data         â”‚
       â”‚                  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                  â”‚                   â”‚
       â”‚                  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
       â”‚                  â”‚ â”‚ Data Masking  â”‚ â”‚
       â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
       â”‚                  â”‚                   â”‚
       â”‚  Masked Data     â”‚                   â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
       â”‚                  â”‚                   â”‚
       â”‚  generate_summaryâ”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚
       â”‚                  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
       â”‚                  â”‚ â”‚ Prompt Render â”‚ â”‚
       â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
       â”‚                  â”‚        â”‚          â”‚
       â”‚                  â”‚        â–¼          â”‚
       â”‚                  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
       â”‚                  â”‚ â”‚    Ollama     â”‚ â”‚
       â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
       â”‚                  â”‚                   â”‚
       â”‚  AI Summary      â”‚                   â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
```

---

## ğŸ”§ é€²éšè¨­å®š

### ä½¿ç”¨å…¶ä»– LLM æ¨¡å‹

ä¿®æ”¹ `.env`ï¼š

```env
# ä½¿ç”¨å…¶ä»– Ollama æ¨¡å‹
OLLAMA_MODEL=llama3:8b

# æˆ–é€£æ¥é ç«¯ Ollama
OLLAMA_BASE_URL=http://192.168.1.100:11434
```

### é€£æ¥ä¼æ¥­å…§éƒ¨ API

```env
# æ›¿æ›ç‚ºä¼æ¥­å…§éƒ¨ API
API_BASE_URL=https://api.yourcompany.internal
```

### ä½¿ç”¨å…¶ä»–è³‡æ–™åº«

ç›®å‰ä½¿ç”¨ SQLiteï¼Œå¯æ“´å±•ç‚ºï¼š

```python
# åœ¨ data_source.py ä¸­æ·»åŠ å…¶ä»–è³‡æ–™åº«é€£æ¥
# ä¾‹å¦‚ PostgreSQLã€MySQL ç­‰
```

---

## â“ å¸¸è¦‹å•é¡Œ

### Q: Ollama ç„¡æ³•é€£æ¥ï¼Ÿ

```powershell
# ç¢ºèª Ollama æ˜¯å¦åŸ·è¡Œä¸­
ollama list

# å¦‚æœæ²’æœ‰ï¼Œå•Ÿå‹•æœå‹™
ollama serve
```

### Q: æ¨¡å‹ä¸å­˜åœ¨ï¼Ÿ

```powershell
# æ‹‰å–æ¨¡å‹
ollama pull gemma3:4b
```

### Q: è³‡æ–™åº«æ‰¾ä¸åˆ°ï¼Ÿ

è³‡æ–™åº«æœƒåœ¨é¦–æ¬¡åŸ·è¡Œæ™‚è‡ªå‹•å»ºç«‹æ–¼ `data/demo.db`ã€‚

### Q: å¦‚ä½•æ–°å¢è‡ªè¨‚ Prompt æ¨¡æ¿ï¼Ÿ

åœ¨ `src/prompts.py` çš„ `_register_default_templates` æ–¹æ³•ä¸­æ·»åŠ ï¼š

```python
self.register(PromptTemplate(
    name="my_template",
    description="æˆ‘çš„è‡ªè¨‚æ¨¡æ¿",
    template="""{{instruction}}
    
è³‡æ–™ï¼š{{data}}

è«‹è™•ç†ä»¥ä¸Šè³‡æ–™ã€‚"""
))
```

---

## ğŸ“– å­¸ç¿’è³‡æº

- [MCP å®˜æ–¹æ–‡ä»¶](https://modelcontextprotocol.io/)
- [MCP TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)
- [MCP Python SDK](https://github.com/modelcontextprotocol/python-sdk)
- [å®˜æ–¹ç¯„ä¾‹ Servers](https://github.com/modelcontextprotocol/servers)
- [Ollama å®˜ç¶²](https://ollama.com/)

---

## ğŸ“„ æˆæ¬Š

MIT License - æ­¡è¿è‡ªç”±ä½¿ç”¨èˆ‡ä¿®æ”¹